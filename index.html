<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Black Mood Studio</title>
  <meta name="description" content="Black Mood Studio" />
  <meta name="title" content="Black Mood Studio" />

  <!-- Social preview / miniatura condivisione -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Black Mood Studio" />
  <meta property="og:title" content="Black Mood Studio" />
  <meta property="og:description" content="Black Mood Studio" />
  <meta property="og:image" content="https://i.postimg.cc/JhbLGYnM/Black-Mood-frame-1400x1400-bg-white.png" />
  <meta property="og:image:width" content="1400" />
  <meta property="og:image:height" content="1400" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Black Mood Studio" />
  <meta name="twitter:description" content="Black Mood Studio" />
  <meta name="twitter:image" content="https://i.postimg.cc/JhbLGYnM/Black-Mood-frame-1400x1400-bg-white.png" />

  <!-- Icone sito -->
  <link rel="icon" href="https://i.postimg.cc/JhbLGYnM/Black-Mood-frame-1400x1400-bg-white.png" />
  <link rel="apple-touch-icon" href="https://i.postimg.cc/JhbLGYnM/Black-Mood-frame-1400x1400-bg-white.png" />
  <meta name="theme-color" content="#0a0a0a" />

  <!-- Font caricati SOLO dopo consenso (Esperienza) per evitare chiamate esterne by-default -->

  <style>
    :root{
      --container:1200px;
      --header-h:72px;
      --logo-h:56px;

      --bg:#0a0a0a;
      --txt:#f3f3f3;
      --muted:#d7d7d7;
      --stroke:rgba(255,255,255,.18);

      --panel-w:min(33.333%, 560px);
      --panel-bg:linear-gradient(180deg, rgba(225,29,72,.35) 0%, rgba(0,0,0,.62) 100%);
      --brand-font:Inter, system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, sans-serif;
      --brand-font-2:Inter, system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, sans-serif;
    }

    /* Se l'utente acconsente ai font esterni, questi due stack verranno "upgradati" in runtime via <link> */

    *{box-sizing:border-box}
    html,body{height:100%; width:100%; overflow-x:hidden}
    body{margin:0; font-family:var(--brand-font); background:var(--bg); color:var(--txt); overflow-x:hidden}
    a{color:inherit; text-decoration:none; overflow-wrap:anywhere; word-break:break-word}
    img{max-width:100%; display:block}
    .container{max-width:var(--container); margin-inline:auto; padding:0 clamp(16px, 2vw, 24px)}

    /* Header */
    header{position:fixed; inset:0 0 auto 0; height:var(--header-h); z-index:50; background:transparent; border-bottom:none}
    header .container.nav{max-width:none; margin-inline:0; padding-inline:12px}

    .nav{display:grid; grid-template-columns:auto 1fr auto; align-items:center; height:100%}
    .brand{display:flex; align-items:center}
    .brand .logo-img{height:var(--logo-h); width:auto; opacity:.8; transition:opacity .2s ease}
    .brand:hover .logo-img{opacity:1}

    nav[aria-label="Sezioni"]{display:flex; align-items:center; justify-content:center; padding-inline:28px}
    nav[aria-label="Sezioni"] ul{display:flex; list-style:none; margin:0; padding:0; width:min(720px, 100%); justify-content:space-between; gap:26px}
    nav[aria-label="Sezioni"] a{font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:.08em; font-size:13px}
    nav[aria-label="Sezioni"] a:hover{color:var(--txt)}

    /* hamburger hidden on desktop */
    .hamburger{display:none; background:none; border:0; width:42px; height:42px; padding:0}

    /* Mobile drawer */
    .mnav{position:fixed; inset:0; z-index:10050; display:grid; justify-items:end; align-items:stretch; background:rgba(0,0,0,.5)}
    .mnav[hidden]{display:none}
    .mnav .panel{width:min(92vw,420px); max-width:100%; height:100vh; background:#0f0f10; border-left:1px solid var(--stroke);
      padding:16px; display:grid; grid-template-rows:auto 1fr; gap:10px}
    .mnav nav ul{display:grid; gap:12px; list-style:none; padding:0; margin:0}
    .mnav nav a{font-weight:600}

    /* Sections */
    html{scroll-padding-top:var(--header-h)}
    section{padding:0; margin:0; scroll-margin-top:calc(var(--header-h) + 10px)}

    .static{position:relative; overflow:hidden}
    .static .media{position:absolute; inset:0; background:#000; z-index:0}
    .static .media img{position:absolute; inset:0; width:100%; height:100%; object-position:center}

    /* vignette */
    .vignette .media::after{content:""; position:absolute; inset:0; pointer-events:none;
      background:radial-gradient(60% 40% at 50% 20%, rgba(0,0,0,.18) 0%, rgba(0,0,0,.6) 72%);
    }

    /* sizes */
    .h-hero{height:100svh; min-height:520px}
    .h-tall{height:120svh; min-height:520px}

    /* fit types */
    .fit-cover .media img{object-fit:cover}
    .fit-contain .media img{object-fit:contain}

    /* side panel */
    .panel{position:absolute; top:0; height:100%; width:var(--panel-w); background:var(--panel-bg);
      display:flex; align-items:center; justify-content:center; z-index:2
    }
    .panel.right{right:0}
    .panel.left{left:0}
    .panel .inner{width:100%; padding:28px; color:#fff}
    .panel h3{margin:0 0 10px; font-family:var(--brand-font-2); font-weight:500; font-size:clamp(18px,2.6vw,28px)}
    .panel p{margin:0 0 10px; color:#e9e9e9; font-size:clamp(14px,1.8vw,16px); line-height:1.45}

    /* Hero */
    .hero .media{background:#000}
    .hero .media img{object-fit:cover}
    .hero .media::after{content:""; position:absolute; inset:0; pointer-events:none;
      background:radial-gradient(60% 40% at 50% 20%, rgba(0,0,0,.15) 0%, rgba(0,0,0,.55) 70%);
    }

    /* Studio short/long */
    .studio-short{display:none}

    /* Services list */
    .service-list{list-style:none; margin:10px 0 0; padding:0}
    .service-list li{margin:0 0 10px; break-inside:avoid}
    .service-list li:last-child{margin-bottom:0}
    .service-list h4{margin:0 0 4px; font-family:var(--brand-font-2); font-weight:600; font-size:clamp(12px,1.4vw,14px); letter-spacing:.06em; text-transform:uppercase}
    .service-list p{margin:0; line-height:1.28; font-size:clamp(13px,1.35vw,14px); color:#ececec}
    #services .panel .inner{padding:26px}
    #services .panel h3{margin-bottom:8px}
    @media (min-width:1100px){
      #services .service-list{columns:2; column-gap:18px}
      #services .service-list li{margin-bottom:12px}
    }

    /* Rooms carousel */
    .rooms{position:relative; height:100svh; min-height:520px; overflow:hidden; background:#000}
    .slides{position:absolute; inset:0; margin:0; padding:0}
    .slide{position:absolute; inset:0; margin:0; padding:0; opacity:0; visibility:hidden; transition:opacity .6s ease}
    .slide.is-active{opacity:1; visibility:visible}
    .slide img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; object-position:center}

    .biglabel{position:absolute; inset:auto 0 18% 0; text-align:center; z-index:2; pointer-events:none}
    .biglabel span{display:inline-block; font-family:var(--brand-font-2); font-weight:700; letter-spacing:.04em; text-transform:uppercase; font-size:clamp(120px,18vw,360px); line-height:.9; color:#fff; opacity:.4}
    .biglabel.is-black span{color:#111; opacity:.55}
    .biglabel .last{display:block}

    .caption{position:absolute; left:24px; bottom:18px; z-index:3; font-size:14px; letter-spacing:.12em; text-transform:uppercase; color:#e9e9e9}
    .controls{position:absolute; inset:auto 24px 18px auto; display:flex; align-items:center; gap:10px; z-index:3}
    .btn{width:42px; height:42px; border-radius:12px; border:1px solid var(--stroke); background:rgba(0,0,0,.45); color:#fff}
    .dots{display:flex; gap:8px}
    .dot{width:8px; height:8px; border-radius:999px; border:1px solid #fff; opacity:.6; background:transparent}
    .dot.is-active{opacity:1; background:#fff}

    /* Work */
    #work{padding-top:0; padding-bottom:0}
    .work .panel{align-items:flex-start; justify-content:center}

    .work-list{display:grid; gap:18px; width:100%; justify-items:end; align-content:start}
    .work-item{border:0; background:transparent; overflow:visible}

    /* Default: mostra SOLO copertine (niente chiamate esterne). Su desktop, gli iframe si attivano solo con consenso. */
    .work-iframe{display:none; width:100%; height:152px; border:0}
    .work-cover{
      display:block;
      width:110px;
      height:110px;
      aspect-ratio:1/1;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.16);
      background:linear-gradient(180deg, rgba(225,29,72,.18), rgba(0,0,0,.55));
      background-size:cover;
      background-position:center;
      background-repeat:no-repeat;
      padding:0;
      cursor:pointer;
    }
    .work-cover .play{display:none}

    /* Desktop: con consenso "Esperienza" -> mostra iframe, nascondi cover */
    @media (min-width:1101px){
      body.consent-experience #work .work-cover{display:none}
      body.consent-experience #work .work-iframe{display:block}
    }

    /* Tablet & Smartphone: copertine piccole a destra, quadrate, senza scritte */
    @media (max-width:1100px){
      #work .work-cover{width:86px; height:86px; border-radius:14px}
      #work .work-iframe{display:none !important}
    }

    /* Footer */
    footer{padding:42px 0 36px; background:#f3f3f3; color:rgba(0,0,0,.85)}
    footer a{color:inherit}
    footer strong{color:inherit}
    .footer-grid{display:grid; grid-template-columns:2fr 1fr; gap:24px}
    .tiny{font-size:13px; color:rgba(0,0,0,.85)}

    .contact-link{display:inline-flex; align-items:center; gap:10px; font-weight:400; color:rgba(0,0,0,.85); max-width:100%; flex-wrap:wrap}
    .icon{width:18px; height:18px; flex:0 0 18px; opacity:1; color:rgba(0,0,0,.85)}
    .icon.lg{width:20px; height:20px; flex-basis:20px}

    .social-list{display:grid; gap:12px; margin-top:10px}
    .social-item a{display:inline-flex; align-items:center; gap:10px; padding:8px 10px; border:1px solid rgba(0,0,0,.12);
      border-radius:14px; background:rgba(0,0,0,.03); color:rgba(0,0,0,.85);
      transition:background .2s ease, border-color .2s ease, transform .2s ease; max-width:100%; min-width:0
    }
    .social-item a:hover{transform:translateY(-1px); border-color:rgba(0,0,0,.18); background:rgba(0,0,0,.06)}
    .social-handle,.social-platform{font-weight:400; color:rgba(0,0,0,.85)}
    .social-platform{font-size:12px; letter-spacing:.08em; text-transform:uppercase; opacity:.9}

    /* Social palettes */
    .social-item a.ig{border-color:rgba(225,48,108,.35); background:linear-gradient(135deg, rgba(225,48,108,.28), rgba(255,220,128,.20), rgba(129,52,175,.22))}
    .social-item a.ig:hover{border-color:rgba(225,48,108,.55); background:linear-gradient(135deg, rgba(225,48,108,.34), rgba(255,220,128,.26), rgba(129,52,175,.28))}
    .social-item a.fb{border-color:rgba(24,119,242,.35); background:linear-gradient(135deg, rgba(24,119,242,.26), rgba(24,119,242,.14))}
    .social-item a.fb:hover{border-color:rgba(24,119,242,.55); background:linear-gradient(135deg, rgba(24,119,242,.32), rgba(24,119,242,.18))}
    .contact-link.wa{padding:8px 10px; border-radius:14px; border:1px solid rgba(37,211,102,.40);
      background:linear-gradient(135deg, rgba(37,211,102,.26), rgba(37,211,102,.14)); color:rgba(0,0,0,.85)}
    .contact-link.wa:hover{border-color:rgba(37,211,102,.60); background:linear-gradient(135deg, rgba(37,211,102,.32), rgba(37,211,102,.18))}

    .footer-links{display:flex; gap:14px; flex-wrap:wrap; align-items:center; margin-top:10px}
    .footer-links a, .footer-links button{font:inherit; color:rgba(0,0,0,.85); background:none; border:0; padding:0; cursor:pointer; text-decoration:underline}

    footer::after{content:""; display:block; height:36px}

    /* Cookie banner */
    .cookie-banner{position:fixed; left:16px; right:16px; bottom:16px; z-index:9999}
    .cookie-card{max-width:980px; margin:0 auto; border-radius:18px; border:1px solid rgba(255,255,255,.14);
      background:linear-gradient(180deg, rgba(225,29,72,.40) 0%, rgba(0,0,0,.82) 100%);
      box-shadow:0 18px 60px rgba(0,0,0,.45);
      padding:14px 14px 12px; color:#fff
    }
    .cookie-row{display:flex; gap:12px; justify-content:space-between; align-items:center; flex-wrap:wrap}
    .cookie-title{font-family:var(--brand-font-2); font-weight:600; letter-spacing:.08em; text-transform:uppercase; font-size:12px; opacity:.95}
    .cookie-text{font-size:13px; line-height:1.35; color:rgba(255,255,255,.92); max-width:720px}
    .cookie-text a{color:#fff; text-decoration:underline}
    .cookie-actions{display:flex; gap:10px}
    .cookie-btn{height:40px; padding:0 14px; border-radius:14px; border:1px solid rgba(255,255,255,.18);
      background:rgba(0,0,0,.35); color:#fff; letter-spacing:.12em; text-transform:uppercase; font-size:11px; cursor:pointer}
    .cookie-btn.primary{background:rgba(255,255,255,.92); color:#0a0a0a; border-color:rgba(255,255,255,.92)}

    /* Smartphone */
    @media (max-width:900px){
      nav[aria-label="Sezioni"]{display:none}
      .hamburger{display:inline-flex; align-items:center; justify-content:center; justify-self:end}
      .hamburger svg, .hamburger path{fill:#fff}

      /* Mobile menu: pannello 1/4 schermo + sfumatura (trasparente a metà) */
      .mnav{
        background:linear-gradient(270deg,
          rgba(0,0,0,.78) 0%,
          rgba(0,0,0,.55) 14%,
          rgba(0,0,0,.28) 32%,
          rgba(0,0,0,0) 50%,
          rgba(0,0,0,0) 100%
        );
      }
      .mnav .panel{
        width:25vw;
        min-width:100px;
        max-width:180px;
        background:linear-gradient(180deg, rgba(225,29,72,.62) 0%, rgba(0,0,0,.80) 55%, rgba(0,0,0,.42) 100%);
        border-left:1px solid rgba(255,255,255,.14);
        padding:18px 12px;
        grid-template-rows:auto 1fr;
        gap:14px;
      }
      .mnav nav ul{gap:14px; justify-items:center; align-content:start}
      .mnav nav a{color:#fff; text-transform:uppercase; letter-spacing:.12em; font-size:11px; font-weight:500; opacity:.92}
      .mnav nav a:hover{opacity:1}

      .h-hero{height:100svh; min-height:420px}
      .rooms{height:100svh; min-height:420px}

      /* Studio & Servizi: foto normale sopra (altezza reale) + pannello testo sotto, senza scroll interno */
      #about, #services{display:block; height:auto; min-height:0}
      #about .media, #services .media{position:relative; inset:auto; height:auto; min-height:0; background:#000}
      #about .media img, #services .media img{position:relative; inset:auto; width:100%; height:auto; object-fit:contain}

      #about .panel, #services .panel{position:relative; left:auto; right:auto; top:auto; bottom:auto; width:100%; height:auto; overflow:visible;
        background:linear-gradient(180deg, rgba(225,29,72,.55) 0%, rgba(0,0,0,.86) 80%)
      }
      #about .panel .inner, #services .panel .inner{padding:18px 18px 22px}

      /* Studio: testo abbreviato su smartphone */
      #about .studio-long{display:none}
      #about .studio-short{display:block}
      #about .studio-short p{margin-bottom:10px}

      /* Servizi: su smartphone mostra solo titoli */
      #services .service-list p{display:none}
      #services .service-list li{margin-bottom:12px}
      #services .service-list h4{margin:10px 0 0}

      /* Rooms label centered on mobile */
      .biglabel{inset:0; display:grid; place-items:center; text-align:center}
      .biglabel span{display:block; width:100%; text-align:center; font-size:clamp(92px, 26vw, 200px)}
      .biglabel .last{width:100%; text-align:center}

      /* Work: copertine ancora più compatte */
      #work .work-cover{width:72px; height:72px}

      .footer-grid{grid-template-columns:1fr}
      footer::after{height:24px}

      .cookie-actions{width:100%; justify-content:flex-end}
    }
  </style>
</head>
<body id="top">

  <!-- ===== Header ===== -->
  <header>
    <div class="container nav">
      <a href="#home" class="brand" aria-label="Black Mood Studio – Home" title="Home">
        <img class="logo-img" src="https://i.postimg.cc/3J6KFQ64/Logo-Black-Mood-white.png" alt="Black Mood Studio" loading="eager" />
      </a>

      <nav aria-label="Sezioni">
        <ul>
          <li><a href="#about">Studio</a></li>
          <li><a href="#services">Servizi</a></li>
          <li><a href="#rooms">Sale</a></li>
          <li><a href="#work">Lavori</a></li>
          <li><a href="#contact">Contatti</a></li>
        </ul>
      </nav>

      <button class="hamburger" aria-label="Apri menu" aria-controls="mobile-nav" aria-expanded="false">
        <svg viewBox="0 0 24 24" aria-hidden="true" width="24" height="24"><path d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"></path></svg>
      </button>
    </div>

    <!-- Mobile Drawer -->
    <aside id="mobile-nav" class="mnav" hidden>
      <div class="panel" role="dialog" aria-modal="true" aria-label="Menu">
<nav>
          <ul>
            <li><a href="#about">Studio</a></li>
            <li><a href="#services">Servizi</a></li>
            <li><a href="#rooms">Sale</a></li>
            <li><a href="#work">Lavori</a></li>
            <li><a href="#contact">Contatti</a></li>
          </ul>
        </nav>
      </div>
    </aside>
  </header>

  <!-- ===== Home ===== -->
  <section id="home" class="hero static h-hero" aria-label="Home">
    <div class="media" aria-hidden="true">
      <img src="https://i.postimg.cc/1t1shRHb/24.jpg" alt="Black Mood Studio – Home" />
    </div>
  </section>

  <!-- ===== Studio ===== -->
  <section id="about" class="static h-hero fit-cover vignette" aria-label="Lo Studio">
    <div class="media" aria-hidden="true">
      <img src="https://i.postimg.cc/j55jTx30/22.jpg" alt="Black Mood Studio – Lo Studio" />
    </div>
    <aside class="panel right" aria-label="Pannello descrizione studio">
      <div class="inner">
        <h3>Lo Studio</h3>

        <div class="studio-long">
          <p>Progettato per lavorare con precisione e continuità, Black Mood Studio integra una live room per riprese e prove, una regia per produzione e overdub e una sala dedicata a mix e mastering.</p>
          <p>Il trattamento acustico con pannelli Vicoustic assicura decisioni affidabili, mentre la connessione tra le sale consente sessioni multitraccia in tempo reale.</p>
          <p>Offriamo produzione, registrazione, editing, mix e mastering con consegna di master e versioni alternative pronte per le piattaforme digitali; disponibili anche stems e specifiche tecniche su richiesta. Le postazioni sono allestite con desk Zaor e sistemi di ascolto Focal per garantire coerenza e traduzione del lavoro.</p>
        </div>

        <div class="studio-short">
          <p>Tre ambienti connessi (live room, regia, mix &amp; mastering) per lavorare in modo continuo e preciso.</p>
          <p>Acustica Vicoustic, desk Zaor e ascolti Focal. Produzione, recording, editing, mix &amp; master con consegne pronte per lo streaming.</p>
        </div>
      </div>
    </aside>
  </section>

  <!-- ===== Servizi ===== -->
  <section id="services" class="static h-hero fit-cover vignette" aria-label="Servizi">
    <div class="media" aria-hidden="true">
      <img src="https://i.postimg.cc/y6DzLCHh/26-B-Flip.jpg" alt="Black Mood Studio – Servizi" />
    </div>
    <aside class="panel left" aria-label="Pannello descrizione servizi">
      <div class="inner">
        <h3>Servizi</h3>
        <ol class="service-list">
          <li><h4>Servizi Custom</h4><p>Soluzioni su misura per esigenze specifiche e progetti particolari.</p></li>
          <li><h4>Registrazioni in Studio</h4><p>Sessioni di registrazione curate in un ambiente professionale.</p></li>
          <li><h4>Produzione &amp; Arrangiamento</h4><p>Supporto creativo e tecnico nello sviluppo dei brani.</p></li>
          <li><h4>Mix &amp; Master</h4><p>Finalizzazione audio mirata e coerente con il progetto.</p></li>
          <li><h4>IR per Chitarre e Bassi</h4><p>Impulse response personalizzati per chitarre e bassi.</p></li>
          <li><h4>Sequenze per Live</h4><p>Sequenze e click track per performance dal vivo.</p></li>
          <li><h4>Consulenza Tecnica / Sessione di Ascolto</h4><p>Ascolto guidato e confronto tecnico sui progetti.</p></li>
          <li><h4>Service Live</h4><p>Supporto audio tecnico per eventi e concerti.</p></li>
        </ol>
      </div>
    </aside>
  </section>

  <!-- ===== Sale ===== -->
  <section id="rooms" class="rooms" aria-label="Le Sale">
    <div class="slides" aria-live="polite">
      <figure class="slide is-active" data-title="STUDIO I"><img src="https://i.postimg.cc/pr70CnRX/IMG-6688.avif" alt="STUDIO I"/></figure>
      <figure class="slide" data-title="STUDIO M"><img src="https://i.postimg.cc/gc6XZ5nV/Blackmood-59.jpg" alt="STUDIO M"/></figure>
      <figure class="slide" data-title="STUDIO R"><img src="https://i.postimg.cc/YSWmLGy7/16.jpg" alt="STUDIO R"/></figure>
    </div>

    <div class="biglabel" aria-hidden="true"><span>STUDIO I</span></div>
    <div class="caption">STUDIO I</div>

    <div class="controls" aria-label="Controlli carosello sale">
      <button class="btn prev" type="button" aria-label="Precedente">‹</button>
      <div class="dots" role="tablist">
        <button class="dot is-active" role="tab" aria-label="Vai a STUDIO I"></button>
        <button class="dot" role="tab" aria-label="Vai a STUDIO M"></button>
        <button class="dot" role="tab" aria-label="Vai a STUDIO R"></button>
      </div>
      <button class="btn next" type="button" aria-label="Successiva">›</button>
    </div>
  </section>

  <!-- ===== Lavori ===== -->
  <section id="work" class="static h-tall fit-contain vignette work" aria-label="Lavori">
    <div class="media" aria-hidden="true">
      <img id="work-img" src="https://i.postimg.cc/QMhTqtGW/Blackmood-89.jpg" data-mobile-src="https://i.postimg.cc/NFmdMppp/Blackmood-91.jpg" alt="Black Mood Studio – Lavori" />
    </div>

    <aside class="panel right" aria-label="Pannello lavori">
      <div class="inner">
        <h3 style="margin-bottom:14px">Lavori</h3>

        <div class="work-list" aria-label="Brani Spotify">
          <div class="work-item" data-spotify-url="https://open.spotify.com/track/1ewFWzfcIjAx4G36WbDgX1">
            <button class="work-cover" type="button" aria-label="Apri brano su Spotify"></button>
            <iframe class="work-iframe" data-src="https://open.spotify.com/embed/track/1ewFWzfcIjAx4G36WbDgX1?theme=0"
              loading="lazy" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
              referrerpolicy="no-referrer-when-downgrade" title="Spotify player"></iframe>
          </div>

          <div class="work-item" data-spotify-url="https://open.spotify.com/track/423yAZqzAQvHCidKPiBhkE">
            <button class="work-cover" type="button" aria-label="Apri brano su Spotify"></button>
            <iframe class="work-iframe" data-src="https://open.spotify.com/embed/track/423yAZqzAQvHCidKPiBhkE?theme=0"
              loading="lazy" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
              referrerpolicy="no-referrer-when-downgrade" title="Spotify player"></iframe>
          </div>

          <div class="work-item" data-spotify-url="https://open.spotify.com/track/2j9His3b2NM30omK6OkzdK">
            <button class="work-cover" type="button" aria-label="Apri brano su Spotify"></button>
            <iframe class="work-iframe" data-src="https://open.spotify.com/embed/track/2j9His3b2NM30omK6OkzdK?theme=0"
              loading="lazy" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
              referrerpolicy="no-referrer-when-downgrade" title="Spotify player"></iframe>
          </div>
        </div>
      </div>
    </aside>
  </section>

  <!-- ===== Footer ===== -->
  <footer id="contact" aria-label="Contatti">
    <div class="container footer-grid">
      <div>
        <p class="tiny"><strong>Contatti</strong></p>
        <p class="tiny">Prenotazioni, preventivi, collaborazioni</p>

        <p class="tiny" style="margin-top:16px"><strong>Scrivici</strong></p>
        <p class="tiny">Email</p>
        <p>
          <a href="mailto:info@blackmoodstudio.com" class="contact-link">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Zm0 4-8 5-8-5V6l8 5 8-5v2Z"/></svg>
            info@blackmoodstudio.com
          </a>
        </p>

        <p class="tiny">Telefono / WhatsApp</p>
        <p>
          <a href="https://wa.me/393484871143" target="_blank" rel="noopener" class="contact-link wa" aria-label="Apri WhatsApp">
            <svg class="icon lg" viewBox="0 0 32 32" aria-hidden="true">
              <path fill="currentColor" d="M19.11 17.36c-.28-.14-1.66-.82-1.92-.91-.26-.1-.45-.14-.64.14-.19.28-.73.91-.9 1.1-.16.19-.33.21-.61.07-.28-.14-1.19-.44-2.27-1.4-.84-.75-1.41-1.68-1.57-1.96-.16-.28-.02-.43.12-.57.12-.12.28-.33.42-.49.14-.16.19-.28.28-.47.09-.19.05-.35-.02-.49-.07-.14-.64-1.54-.87-2.11-.23-.56-.47-.48-.64-.49-.16-.01-.35-.01-.54-.01s-.49.07-.75.35c-.26.28-.98.96-.98 2.34 0 1.38 1 2.72 1.14 2.91.14.19 1.97 3.01 4.78 4.22.67.29 1.19.46 1.6.59.67.21 1.28.18 1.76.11.54-.08 1.66-.68 1.89-1.33.23-.66.23-1.22.16-1.33-.07-.12-.26-.19-.54-.33Z"/>
              <path fill="currentColor" d="M16.02 3C8.84 3 3 8.82 3 16c0 2.29.6 4.53 1.74 6.51L3 29l6.67-1.7A12.93 12.93 0 0 0 16.02 29C23.2 29 29 23.18 29 16S23.2 3 16.02 3Zm0 23.6c-2.03 0-4.01-.54-5.73-1.55l-.41-.24-3.96 1.01 1.06-3.86-.27-.4A10.6 10.6 0 0 1 5.4 16c0-5.86 4.77-10.6 10.62-10.6S26.64 10.14 26.64 16s-4.77 10.6-10.62 10.6Z"/>
            </svg>
            348 4871143
          </a>
        </p>
      </div>

      <div>
        <p class="tiny"><strong>Social</strong></p>
        <div class="social-list" aria-label="Social links">
          <div class="social-item">
            <a class="ig" href="https://www.instagram.com/blackmoodstudio?igsh=OGIyOXl4OGdtcXJ2&utm_source=qr" target="_blank" rel="noopener">
              <svg class="icon lg" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2Zm0 2A3.75 3.75 0 0 0 4 7.75v8.5A3.75 3.75 0 0 0 7.75 20h8.5A3.75 3.75 0 0 0 20 16.25v-8.5A3.75 3.75 0 0 0 16.25 4h-8.5Zm10.2 2.4a.9.9 0 1 1 0 1.8.9.9 0 0 1 0-1.8ZM12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"/></svg>
              <div>
                <div class="social-handle">@blackmoodstudio</div>
                <div class="social-platform">Instagram</div>
              </div>
            </a>
          </div>
          <div class="social-item">
            <a class="fb" href="https://www.facebook.com/share/17k13UUqeF/?mibextid=wwXIfr" target="_blank" rel="noopener">
              <svg class="icon lg" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M13.5 22v-8h2.7l.4-3h-3.1V9.1c0-.9.2-1.5 1.5-1.5h1.7V5c-.3 0-1.5-.1-2.8-.1-2.8 0-4.7 1.7-4.7 4.8V11H6v3h3.2v8h4.3Z"/></svg>
              <div>
                <div class="social-handle">Black Mood Studio</div>
                <div class="social-platform">Facebook</div>
              </div>
            </a>
          </div>
        </div>

        <div style="margin-top:16px">
          <p class="tiny"><strong>Indirizzo</strong></p>
          <p>Via Nino Oxilia 4<br>28100 Novara (NO)</p>
          <p class="tiny">Parcheggio facile • Accesso carico/scarico</p>
        </div>
      </div>
    </div>

    <div class="container" style="margin-top:18px">
      <p class="tiny">© <span id="year"></span> Black Mood Studio — Recording • Mixing • Mastering</p>
      <div class="footer-links">
        <a href="https://sites.google.com/view/privacy-blackmoodstudio/home-page" target="_blank" rel="noopener">Privacy &amp; Cookie Policy</a>
        <button type="button" id="cookie-settings">Preferenze cookie</button>
      </div>
    </div>
  </footer>

  <!-- ===== Cookie Banner (stile pannelli) ===== -->
  <div id="cookie-banner" class="cookie-banner" hidden>
    <div class="cookie-card" role="dialog" aria-live="polite" aria-label="Preferenze cookie">
      <div class="cookie-row">
        <div>
          <div class="cookie-title">Cookie &amp; contenuti esterni</div>
          <div class="cookie-text">
            Usiamo strumenti necessari e, solo con consenso, contenuti esterni (es. Spotify) e font.
            <a href="https://sites.google.com/view/privacy-blackmoodstudio/home-page" target="_blank" rel="noopener">Leggi la policy</a>.
          </div>
        </div>
        <div class="cookie-actions">
          <button class="cookie-btn" type="button" data-consent="reject">Rifiuta</button>
          <button class="cookie-btn primary" type="button" data-consent="accept">Accetta</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Helpers
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));
    const $  = (sel, ctx=document) => ctx.querySelector(sel);
    const on = (el, ev, fn, opts) => el && el.addEventListener(ev, fn, opts);
    const debounce = (fn, ms=140)=>{ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), ms); }; };

    // Year
    const y = $('#year'); if(y) y.textContent = new Date().getFullYear();

    // ===== Consent Manager (default = nega tutto tranne necessari) =====
    const CONSENT_KEY = 'bms_consent_v1';
    const POLICY_URL  = 'https://sites.google.com/view/privacy-blackmoodstudio/home-page';

    function getConsent(){
      try{ return JSON.parse(localStorage.getItem(CONSENT_KEY)); }
      catch{ return null; }
    }
    function setConsent(consent){
      localStorage.setItem(CONSENT_KEY, JSON.stringify(consent));
    }

    function ensureCssLink(id, href){
      if(document.getElementById(id)) return;
      const l = document.createElement('link');
      l.id = id; l.rel = 'stylesheet'; l.href = href;
      document.head.appendChild(l);
    }

    function loadFonts(){
      // Caricati SOLO dopo consenso Esperienza
      ensureCssLink('gf-inter', 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
      ensureCssLink('gf-space', 'https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
      // Quando i font arrivano, lo stack già include fallback; qui non serve altro.
    }

    function loadSpotifyOembed(){
      // Chiamate a terze parti SOLO dopo consenso Esperienza
      const items = $$('#work .work-item');
      items.forEach(item => {
        if(item.dataset.oembedLoaded === '1') return;
        const cover = $('.work-cover', item);
        const trackUrl = item.getAttribute('data-spotify-url') || '';
        if(!cover || !trackUrl) return;

        item.dataset.oembedLoaded = '1';
        fetch('https://open.spotify.com/oembed?url=' + encodeURIComponent(trackUrl))
          .then(r => r.ok ? r.json() : null)
          .then(data => {
            if(!data) return;
            if(data.thumbnail_url) cover.style.backgroundImage = `url("${data.thumbnail_url}")`;
            if(data.title) cover.setAttribute('aria-label', data.title);
          })
          .catch(()=>{ item.dataset.oembedLoaded = '0'; });
      });
    }

    function applyConsent(consent){
      const experienceAllowed = !!consent?.experience;
      document.body.classList.toggle('consent-experience', experienceAllowed);

      // 1) Spotify iframes: attiva solo se consentito
      $$('iframe[data-src]').forEach((iframe) => {
        if(experienceAllowed){
          if(!iframe.src) iframe.src = iframe.dataset.src;
        }else{
          iframe.removeAttribute('src');
        }
      });

      // 2) oEmbed copertine (fetch) solo se consentito
      if(experienceAllowed){
        loadSpotifyOembed();
        loadFonts();
      }
    }

    function showCookieBanner(){
      const b = $('#cookie-banner');
      if(b) b.hidden = false;
    }
    function hideCookieBanner(){
      const b = $('#cookie-banner');
      if(b) b.hidden = true;
    }

    function acceptAll(){
      const c = { necessary:true, experience:true };
      setConsent(c);
      applyConsent(c);
      hideCookieBanner();
    }

    function rejectAll(){
      const c = { necessary:true, experience:false };
      setConsent(c);
      applyConsent(c);
      hideCookieBanner();
    }

    // Init consent: default rifiuta finché l'utente non sceglie
    const stored = getConsent();
    const initial = stored || { necessary:true, experience:false };
    applyConsent(initial);
    if(!stored) showCookieBanner();

    // Banner buttons
    (function(){
      const banner = $('#cookie-banner');
      if(!banner) return;
      const acceptBtn = $('[data-consent="accept"]', banner);
      const rejectBtn = $('[data-consent="reject"]', banner);
      on(acceptBtn,'click', acceptAll);
      on(rejectBtn,'click', rejectAll);
    })();

    // Footer: apri preferenze cookie
    on($('#cookie-settings'), 'click', ()=> showCookieBanner());

    // ===== Mobile menu (tap fuori, link, ESC) =====
    (function(){
      const btn = $('.hamburger');
      const drawer = $('#mobile-nav');
      if(!btn || !drawer) return;

      const lockScroll = () => { document.body.style.overflow = 'hidden'; };
      const unlockScroll = () => { document.body.style.overflow = ''; };

      const open = () => {
        drawer.hidden = false;
        btn.setAttribute('aria-expanded','true');
        lockScroll();
      };
      const close = () => {
        drawer.hidden = true;
        btn.setAttribute('aria-expanded','false');
        unlockScroll();
      };

      // toggle sullo stesso pulsante
      on(btn, 'click', ()=> (drawer.hidden ? open() : close()));
      on(drawer, 'click', (e)=>{ if(e.target===drawer) close(); });

      // Link del menu: chiudi e usa l'anchor nativa (super compatibile)
      $$('.mnav a', drawer).forEach(a => on(a,'click', (e)=>{
        const href = a.getAttribute('href') || '';
        if(href.startsWith('#')){
          e.preventDefault();
          close();
          // Cambia hash DOPO aver sbloccato lo scroll (altrimenti su alcuni browser non scorre)
          setTimeout(()=>{ if(location.hash !== href) location.hash = href; }, 0);
        }else{
          close();
        }
      }));

      on(document, 'keydown', (e)=>{ if(!drawer.hidden && e.key==='Escape') close(); });
    })();

    // ===== Lavori: click sulle copertine apre Spotify (azione dell'utente) =====
    function setupWorkCoverClicks(){
      $$('#work .work-item').forEach(item => {
        if(item.dataset.coverInit === '1') return;
        item.dataset.coverInit = '1';
        const cover = $('.work-cover', item);
        const trackUrl = item.getAttribute('data-spotify-url') || '';
        if(!cover || !trackUrl) return;
        on(cover, 'click', ()=> window.open(trackUrl, '_blank', 'noopener'));
      });
    }

    // Work: swap mobile background
    function syncWorkBackground(){
      const img = $('#work-img');
      if(!img) return;
      img.dataset.desktopSrc ||= img.getAttribute('src') || '';
      const vw = window.innerWidth || document.documentElement.clientWidth;
      const mob = img.getAttribute('data-mobile-src') || '';
      if(vw <= 900 && mob) img.src = mob;
      if(vw > 900 && img.dataset.desktopSrc) img.src = img.dataset.desktopSrc;
    }

    // ===== Rooms carousel =====
    function initRooms(){
      const root = $('#rooms');
      if(!root) return;
      const slides = $$('.slide', root);
      const dots = $$('.dot', root);
      const prevBtn = $('.prev', root);
      const nextBtn = $('.next', root);
      const caption = $('.caption', root);
      const bigWrap = $('.biglabel', root);
      const bigSpan = $('span', bigWrap);

      const splitLast = (t='') => {
        t = (t||'').toString().trim();
        if(!t) return '';
        const head = t.slice(0,-1).trim();
        const last = t.slice(-1);
        return `${head}<span class="last">${last}</span>`;
      };

      let idx = 0;
      let timer;
      const AUTOPLAY = 5000;

      const activate = (i) => {
        if(!slides.length) return;
        idx = (i + slides.length) % slides.length;
        slides.forEach((s,j)=>{
          const onSlide = j===idx;
          s.classList.toggle('is-active', onSlide);
          dots[j]?.classList.toggle('is-active', onSlide);
        });
        const title = slides[idx].getAttribute('data-title') || '';
        if(caption) caption.textContent = title;
        if(bigSpan){
          bigSpan.innerHTML = splitLast(title);
          bigWrap?.classList.toggle('is-black', title === 'STUDIO R');
        }
      };

      const next = () => activate(idx+1);
      const prev = () => activate(idx-1);
      const stop = () => { if(timer) { clearInterval(timer); timer=null; } };
      const start = () => { stop(); timer=setInterval(next, AUTOPLAY); };

      on(prevBtn,'click', ()=>{ prev(); start(); });
      on(nextBtn,'click', ()=>{ next(); start(); });
      dots.forEach((d,j)=> on(d,'click', ()=>{ activate(j); start(); }));

      // swipe
      let sx=0;
      on(root,'touchstart', (e)=>{ sx=e.changedTouches[0].clientX; }, {passive:true});
      on(root,'touchend', (e)=>{
        const dx = e.changedTouches[0].clientX;
        if(Math.abs(dx-sx)>40){ (dx<sx?next:prev)(); start(); }
      }, {passive:true});

      activate(0);
      setTimeout(start, 600);
    }

    // ===== Init =====
    setupWorkCoverClicks();
    syncWorkBackground();
    initRooms();

    window.addEventListener('resize', debounce(()=>{
      syncWorkBackground();
      // se l'utente ha già dato consenso, su resize ricarichiamo oembed se serve
      const c = getConsent();
      if(c?.experience) loadSpotifyOembed();
    }));

    // Sanity checks (non bloccanti)
    (function(){
      try{
        console.groupCollapsed('[DEBUG] Sanity checks');
        console.assert(!!document.querySelector('#rooms .slides'), 'Rooms: slides presenti');
        console.assert(!!document.querySelector('#services .media img'), 'Services: immagine presente');
        console.assert(($$('iframe[data-src]').length===3), 'Work: 3 iframe data-src');
        console.assert(!!document.querySelector('header nav ul'), 'Header: nav OK');
        console.groupEnd();
      }catch(e){}
    })();
  </script>
</body>
</html>
